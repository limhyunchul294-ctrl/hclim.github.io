# SMS Gateway 문제 해결 가이드

## 🔧 기본 앱 설정 확인

### 1. 안드로이드 기본 SMS 앱 설정

SMS Gateway 앱이 SMS를 전송하려면 **기본 SMS 앱으로 설정**되어야 할 수 있습니다.

#### 설정 방법:

1. **안드로이드 설정 열기**
   - 설정 앱 실행
   - "앱" 또는 "애플리케이션" 선택

2. **기본 앱 설정**
   - "기본 앱" 또는 "기본 애플리케이션" 선택
   - "SMS 앱" 또는 "메시지 앱" 선택
   - **SMS Gateway 앱 선택**

3. **또는 직접 SMS 앱 변경**
   - 설정 → 앱 → SMS Gateway 앱
   - "기본값으로 설정" 옵션 확인
   - "SMS 앱으로 설정" 옵션이 있으면 선택

### 2. SMS Gateway 앱 권한 확인

#### 필수 권한:

1. **SMS 권한**
   - SMS 전송 권한
   - SMS 수신 권한 (선택사항)

2. **네트워크 권한**
   - 인터넷 접근 권한
   - 로컬 네트워크 접근 권한

3. **알림 권한** (선택사항)
   - 전송 상태 알림용

#### 권한 확인 방법:

1. 설정 → 앱 → SMS Gateway 앱
2. "권한" 또는 "Permissions" 선택
3. 필수 권한이 모두 허용되어 있는지 확인

### 3. SMS Gateway 앱 설정 확인

#### 확인 사항:

1. **HTTP API 서버 활성화**
   - Gateway 설정 화면에서 "Enable service" 또는 "서비스 활성화" 체크 확인

2. **포트 확인**
   - 설정된 포트 번호 (8082)
   - 방화벽이 해당 포트를 차단하지 않는지 확인

3. **토큰 확인**
   - LOCAL SERVICE의 Token 값 확인
   - `.env` 파일의 `SMS_GATEWAY_TOKEN`과 일치하는지 확인

4. **인증 설정**
   - 인증이 필요한 경우: 토큰 사용
   - 인증이 불필요한 경우: 설정에서 비활성화 가능한지 확인

### 4. 네트워크 연결 확인

#### 동일한 WiFi 네트워크:

1. **PC와 안드로이드 폰이 같은 WiFi에 연결되어 있는지 확인**
   - PC의 IP 주소 확인: `ipconfig` (Windows) 또는 네트워크 설정
   - 안드로이드 폰의 IP 주소 확인: WiFi 설정 → 네트워크 정보
   - 같은 네트워크 대역 (예: 192.168.1.x)인지 확인

2. **방화벽 확인**
   - 안드로이드 폰의 방화벽이 8082 포트를 차단하지 않는지 확인
   - PC의 방화벽이 안드로이드 폰과의 통신을 허용하는지 확인

### 5. API 테스트

#### 브라우저에서 직접 테스트:

1. **서버 연결 확인**
   ```
   http://192.168.1.141:8082
   ```
   - 페이지가 열리면 서버가 정상 작동 중

2. **API 문서 확인**
   - 화면에 표시된 API 형식 확인
   - 토큰 사용 방법 확인

3. **Postman 또는 curl로 테스트** (선택사항)
   ```bash
   curl -X POST http://192.168.1.141:8082 \
     -H "Content-Type: application/json" \
     -d '{"to": "+821064308096", "message": "Test", "token": "359e9a60-d985-4021-959f-4fd62f9f3fe9"}'
   ```

### 6. 일반적인 오류 해결

#### 401 Unauthorized 오류:

1. **토큰 확인**
   - SMS Gateway 앱의 Token 값과 `.env`의 `SMS_GATEWAY_TOKEN` 일치 확인
   - 토큰에 공백이나 특수문자가 포함되지 않았는지 확인

2. **인증 방식 확인**
   - 앱 설정에서 인증 방식 확인
   - 토큰을 헤더에 보낼지, 본문에 포함할지 확인
   - API 문서에 명시된 인증 방식 확인

3. **인증 비활성화 시도**
   - 앱 설정에서 인증을 일시적으로 비활성화해 테스트
   - 작동하면 인증 방식 문제

#### 연결 오류:

1. **IP 주소 확인**
   - 안드로이드 폰의 IP 주소가 변경되지 않았는지 확인
   - WiFi 재연결 시 IP 주소가 변경될 수 있음

2. **포트 확인**
   - SMS Gateway 앱에서 설정한 포트 번호 확인
   - `.env` 파일의 포트 번호와 일치하는지 확인

3. **서버 상태 확인**
   - SMS Gateway 앱이 실행 중인지 확인
   - HTTP API 서버가 활성화되어 있는지 확인

### 7. 단계별 체크리스트

- [ ] SMS Gateway 앱이 기본 SMS 앱으로 설정됨
- [ ] SMS 전송 권한이 허용됨
- [ ] HTTP API 서버가 활성화됨
- [ ] 포트 번호가 올바름 (8082)
- [ ] Token 값이 `.env` 파일과 일치함
- [ ] PC와 안드로이드 폰이 같은 WiFi 네트워크에 연결됨
- [ ] 방화벽이 해당 포트를 차단하지 않음
- [ ] 브라우저에서 `http://192.168.1.141:8082` 접속 가능

### 8. 추가 도움말

문제가 계속되면:

1. **SMS Gateway 앱 재시작**
   - 앱 완전 종료 후 다시 실행
   - 안드로이드 폰 재부팅

2. **앱 설정 초기화** (최후의 수단)
   - 앱 설정에서 초기화 옵션 확인
   - 다시 처음부터 설정

3. **다른 SMS Gateway 앱 시도**
   - 다른 SMS Gateway 앱 설치하여 테스트
   - API 형식이 더 명확한 앱 선택


